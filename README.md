<!-- DO NOT EDIT DIRECTLY -->
<!-- This file is autogenerated from https://github.com/timdeschryver/zod-fixture/edit/main/docs/index.md -->
<h1 align="center">Zod Fixture</h1>
<p align="center">Fixture Generation with 1:1 Zod Parity</p>
<br>
<p align="center" style="display: flex; gap: .5em; justify-content:center">
	<a href="https://badge.fury.io/js/zod-fixture"><img src="https://badge.fury.io/js/zod-fixture.svg" alt="npm version" height="18"></a>
	<a href="https://github.com/timdeschryver/zod-fixture/actions/workflows/ci.yaml"><img src="https://github.com/timdeschryver/zod-fixture/actions/workflows/ci.yaml/badge.svg?branch=beta"></a>
	<a href="https://opensource.org/licenses/MIT" rel="nofollow"><img src="https://img.shields.io/github/license/timdeschryver/zod-fixture" alt="License"></a>
	<a href="https://www.npmjs.com/package/zod-fixture" rel="nofollow"><img src="https://img.shields.io/github/stars/timdeschryver/zod-fixture" alt="stars"></a>
</p>
<br>
<p align="center">
Creating test fixtures should be easy.<br>
<a href="https://github.com/timdeschryver/zod-fixture">zod-fixture</a> helps with the arrange phase of your tests by creating test fixtures based on a <a href="https://zod.dev/">zod</a> schema.
</p>

## Table of Contents

- [Table of Contents](#table-of-contents)
- [Installation](#installation)
- [Getting Started](#getting-started)
- [Customizing](#customizing)
  - [Extending](#extending)
  - [Generators](#generators)
- [FAQ](#faq)
  - [I have a custom type that I need to support. How do I do that?](#i-have-a-custom-type-that-i-need-to-support-how-do-i-do-that)
  - [Do you support faker/chance/falso?](#do-you-support-fakerchancefalso)
- [API](#api)
  - [Fixture / Transformer](#fixture--transformer)
    - [Config](#config)
      - [Seed (optional)](#seed-optional)
      - [Defaults (optional)](#defaults-optional)
- [Advanced Topics](#advanced-topics)
  - [Create Your Own Transformer](#create-your-own-transformer)
- [Contributing](#contributing)
  - [Getting started with GitHub Codespaces](#getting-started-with-github-codespaces)
  - [StackBlitz](#stackblitz)
- [Blog posts](#blog-posts)
- [Credits](#credits)

## Installation

```sh [npm]
npm install -D vitepress
```

```sh [pnpm]
pnpm add -D vitepress
```

```sh [yarn]
yarn add -D vitepress
```

```sh [bun]
bun add -d zod-fixture
```

## Getting Started

The easiest way to start using `zod-fixture` is to import the pre-configured `createFixture` function.

<sub>[Example](https://github.com/timdeschryver/zod-fixture/tree/beta/examples/fixture-person.test.ts)</sub>

```ts
import { z } from 'zod';
import { createFixture } from 'zod-fixture';

const PersonSchema = z.object({
	name: z.string(),
	birthday: z.date(),
	address: z.object({
		street: z.string(),
		city: z.string(),
		state: z.string(),
	}),
	pets: z.array(z.object({ name: z.string(), breed: z.string() })),
	totalVisits: z.number().int().positive(),
});

const person = createFixture(PersonSchema, { seed: 11 });
```

<sub>[Output](https://github.com/timdeschryver/zod-fixture/tree/beta/examples/fixture-person.test.ts)</sub>

```ts
{
	address: {
		city: 'bonzm-sjnglvkbb',
		state: 'fbmiabahyvsy-vm',
		street: 'etuqnbvmbkqwlty',
	},
	birthday: new Date('2073-08-30T03:26:04.735Z'),
	name: 'd-iveauywljfifd',
	pets: [
		{
			breed: 'ifsztjznktjkveu',
			name: 'qbjuehl-trb-aiu',
		},
		{
			breed: 'q-jcmhccaduqmkq',
			name: 'rrvbrgzmjhttzhj',
		},
		{
			breed: 'rgsnffunjalqicp',
			name: 'tolkjleyvtwitax',
		},
	],
	totalVisits: 21,
}

```

Take a look at the [examples](https://github.com/timdeschryver/zod-fixture/examples) to see how you can use `zod-fixture` in your tests.

> INFO: The examples make use of the optional [seed](#seed-optional) parameter to generate the same fixture every time. This is useful for our docs, or to reproduce issues, but is not necessary in your code. Simply calling `new Fixture()` is acceptable.

## Customizing

`zod-fixture` is highly customizable. We provide you with the same utility methods we use internally to give you fine-grained support for creating your own fixtures.

### Extending

The easiset way to start customizing `zod-fixture` is to extend the `Fixture` class with your own [generator](#generators).

The example below uses 2 custom generators and a typical pattern for filtering based on the keys of an object.

<sub>[Example](https://github.com/timdeschryver/zod-fixture/tree/beta/examples/fixture-extension.test.ts)</sub>

```ts
import { ZodNumber, ZodObject, z } from 'zod';
import { Fixture, Generator } from 'zod-fixture';
const totalVisitsGenerator = Generator({
	schema: ZodNumber,
	filter: ({ context }) => context.path.at(-1) === 'totalVisits',
	/**
	 * The `context` provides a path to the current field
	 *
	 * {
	 *   totalVisits: ...,
	 *   nested: {
	 *     totalVisits: ...,
	 *   }
	 * }
	 *
	 * Would match twice with the following paths:
	 *   ['totalVisits']
	 *   ['nested', 'totalVisits']
	 */

	// returns a more realistic number of visits.
	output: ({ transform }) => transform.utils.random.int({ min: 0, max: 25 }),
});
const addressGenerator = Generator({
	schema: ZodObject,
	filter: ({ context }) => context.path.at(-1) === 'address',
	// returns a custom address object
	output: () => ({
		street: 'My Street',
		city: 'My City',
		state: 'My State',
	}),
});

const PersonSchema = z.object({
	name: z.string(),
	birthday: z.date(),
	address: z.object({
		street: z.string(),
		city: z.string(),
		state: z.string(),
	}),
	pets: z.array(z.object({ name: z.string(), breed: z.string() })),
	totalVisits: z.number().int().positive(),
});

const fixture = new Fixture({ seed: 38 }).extend([
	addressGenerator,
	totalVisitsGenerator,
]);
const person = fixture.fromSchema(PersonSchema);
```

<sub>[Output](https://github.com/timdeschryver/zod-fixture/tree/beta/examples/fixture-extension.test.ts)</sub>

```ts
{
	address: {
		city: 'My City',
		state: 'My State',
		street: 'My Street',
	},
	birthday: new Date('2091-09-17T10:54:58.574Z'),
	name: 'sdnlwozmxaigobr',
	pets: [
		{
			breed: 'fbgglityarecl-q',
			name: '-lmtvotjcevmyiq',
		},
		{
			breed: 'mylchvprjdgelkq',
			name: 'devqfcctdx-link',
		},
		{
			breed: 'rcrrkytqrdmzajo',
			name: 'ivrplyhts-yypas',
		},
	],
	totalVisits: 4,
}

```

> TIP: The order the registered generators matters. The first generator that matches the conditions (`schema` and `filter`) is used to create the value.

### Generators

To generate a value based on a zod type we're using what we call a `Generator`.

A `Generator` has 3 fundamental parts:

- `schema` -- the zod type to match
- `filter` -- [optional] a function to further refine our match (ie filtering by keys or zod checks)
- `output` -- a function that's called to produce the fixture

To help you to create your own generators this library also includes some useful utility methods to generate data.
For example, in the example below we create our own `totalVisitsGenerator` to return more realastic numbers using the `random` utilities.

<sub>[Source](https://github.com/timdeschryver/zod-fixture/tree/beta/examples/fixture-extension.test.ts)</sub>

```ts
const totalVisitsGenerator = Generator({
	schema: ZodNumber,
	filter: ({ context }) => context.path.at(-1) === 'totalVisits',
	/**
	 * The `context` provides a path to the current field
	 *
	 * {
	 *   totalVisits: ...,
	 *   nested: {
	 *     totalVisits: ...,
	 *   }
	 * }
	 *
	 * Would match twice with the following paths:
	 *   ['totalVisits']
	 *   ['nested', 'totalVisits']
	 */

	// returns a more realistic number of visits.
	output: ({ transform }) => transform.utils.random.int({ min: 0, max: 25 }),
});
```

## FAQ

### I have a custom type that I need to support. How do I do that?

`zod-fixture` was built with this in mind. Simply define your custom type using zod's `z.custom` and pass the resulting schema to your custom generator.

<sub>[Example](https://github.com/timdeschryver/zod-fixture/tree/beta/examples/custom-type.test.ts)</sub>

```ts
import { z } from 'zod';
import { Fixture, Generator } from 'zod-fixture';

// Your custom type
const pxSchema = z.custom<`${number}px`>((val) => {
	return /^\d+px$/.test(val as string);
});

// Your custom generator
const PixelGenerator = Generator({
	schema: pxSchema,
	output: () => '100px',
});

// Example
const resolutionSchema = z.object({
	width: pxSchema,
	height: pxSchema,
});

const fixture = new Fixture().extend([PixelGenerator]);
const resolution = fixture.fromSchema(resolutionSchema);
```

<sub>[Output](https://github.com/timdeschryver/zod-fixture/tree/beta/examples/custom-type.test.ts)</sub>

```ts
{
	width: '100px',
	height: '100px',
}

```

### Do you support faker/chance/falso?

The short answer, not yet. We plan to build out pre-defined generators for popular mocking libraries but are currently prioritizing reliability and ease of use. If you'd like to help us build out this functionality, feel free to open a pull request ðŸ˜€

## API

### Fixture / Transformer

> INFO: `Fixture` is a `Transformer` that comes prepackaged with generators for each of the first party types that Zod provides. For most cases, this is all you wil need, and offers a fast and easy way to create fixtures. For building a custom `Transformer` refer to the [Advanced](#advanced-topics) documentation.

#### Config

<sub>[Source](https://github.com/timdeschryver/zod-fixture/tree/beta/src/types/zod-fixture.d.ts)</sub>

```ts
interface TransformerConfig {
	seed?: number;
	defaults?: Partial<Defaults>;
}
```

##### Seed (optional)

A seed can be provided to produce the same results every time.

```ts
new Fixture({ seed: number });
```

##### Defaults (optional)

We provide sane defaults for the random utilities used by our generators, but these can easily be customized.

<sub>[Source](https://github.com/timdeschryver/zod-fixture/tree/beta/src/types/zod-fixture.d.ts)</sub>

```ts
interface Defaults {
	array: {
		min: number; // 3
		max: number; // 3
	};
	map: {
		min: number; // 3
		max: number; // 3
	};
	set: {
		min: number; // 3
		max: number; // 3
	};
	int: {
		min: number; // Number.MIN_SAFE_INTEGER
		max: number; // Number.MAX_SAFE_INTEGER
	};
	float: {
		min: number; // Number.MIN_SAFE_INTEGER
		max: number; // Number.MAX_SAFE_INTEGER
	};
	bigint: {
		min: bigint; // BigInt(Number.MIN_SAFE_INTEGER)
		max: bigint; // BigInt(Number.MAX_SAFE_INTEGER)
	};
	date: {
		min: number; // Date.UTC(1900, 0, 1)
		max: number; // Date.UTC(2100, 11, 31)
	};
}
```

## Advanced Topics

### Create Your Own Transformer

Instead of using the opinionated `Fixture` class, you can extend the unopinionated `Transformer` and register the desired generators.

<sub>[Source](https://github.com/timdeschryver/zod-fixture/tree/beta/examples/transformer.ts)</sub>

```ts
import { z } from 'zod';
import { UnconstrainedFixture } from 'zod-fixture';

const transform = new UnconstrainedFixture().extend([
	/* insert your generators here */
]);

transform.fromSchema(z.any());
```

## Contributing

### Getting started with GitHub Codespaces

To get started, create a codespace for this repository by clicking this ðŸ‘‡

[![Open in GitHub Codespaces](https://github.com/codespaces/badge.svg)](https://github.com/codespaces/new?hide_repo_select=true&ref=main&repo=515959275)

A codespace will open in a web-based version of Visual Studio Code. The [dev container](.devcontainer/devcontainer.json) is fully configured with software needed for this project.

**Note**: Dev containers is an open spec which is supported by [GitHub Codespaces](https://github.com/codespaces) and [other tools](https://containers.dev/supporting).

### StackBlitz

[![Open in StackBlitz](https://developer.stackblitz.com/img/open_in_stackblitz.svg)](https://stackblitz.com/edit/vitejs-vite-4nsv9h?file=src/preview.ts)

## Blog posts

- [Why we should verify HTTP response bodies, and why we should use zod for this](https://timdeschryver.dev/blog/why-we-should-verify-http-response-bodies-and-why-we-should-use-zod-for-this)
- [How zod-fixture can help with your test setups](https://timdeschryver.dev/blog/how-zod-fixture-can-help-with-your-test-setups)
- [Using zod-fixture with MSW to generate mocked API responses](https://timdeschryver.dev/blog/using-zod-fixture-with-msw-to-generate-mocked-api-responses)

## Credits

This package is inspired on [AutoFixture](https://github.com/AutoFixture/AutoFixture).
